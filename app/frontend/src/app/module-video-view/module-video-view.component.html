<div class="questions-container">
  <div class="back-nav">
    <button class="back-button" (click)="goBackToOverview()">
      <fa-icon [icon]="faArrowLeft"></fa-icon>
      {{ "MODULE_VIDEO.BACK_TO_OVERVIEW" | translate }}
    </button>
  </div>

  <div class="progress-indicator">
    <div class="module-name">
      {{ moduleTitle }} - {{ "MODULE_VIDEO.VIDEO" | translate }}
    </div>
    <div class="step-indicator">
      {{ "MODULE_VIDEO.STEP" | translate }} {{ getStepIndicatorText() }}
    </div>
  </div>

  <div class="progress-bar">
    <div
      class="progress-fill"
      [style.width]="getProgressPercentage() + '%'"
    ></div>
  </div>

  <div class="module-content">

    <div class="content-header">
      <h1>{{ module.title[languageService.getLanguage()] }}</h1>
      <p>{{ module.description[languageService.getLanguage()] }}</p>
    </div>
    @for(content of module.content; track $index) {
      @if(content.content_type.toString()=='TEXT') {
        <div class="content-item content-text">
          <p >{{content.reference[languageService.getLanguage()]}}</p>
        </div>
      }
      @else if(content.content_type.toString()=='PICTURE') {
        <div class="content-item content-picture">
          <img [src]="content.reference[languageService.getLanguage()]" alt="">
        </div>
      }
      @else if(content.content_type.toString()=='VIDEO') {
      <div class="content-item">
        <div class="video-container">
          <video
            #videoPlayer
            [src]="content.reference[languageService.getLanguage()]"
            controls
            (timeupdate)="updateVideoProgress($event)"
            (pause)="saveVideoProgress()"
            (ended)="videoCompleted = true; saveVideoProgress()"
          >
            Your browser does not support the video tag. Please try using a
            different browser.
          </video>
    
          <div class="video-progress-indicator" *ngIf="videoCompleted">
            <div class="completion-badge">
              {{ "MODULE_VIDEO.VIDEO_COMPLETED" | translate }}
            </div>
          </div>
        </div>
      </div>
      }
      @else {
        <p>{{content.content_type}}</p>
      }
    }

    <div class="action-buttons">
      <button
        class="continue-button"
        (click)="continueToQuestions()"
        [disabled]="questionCount === 0"
      >
        {{ "MODULE_VIDEO.CONTINUE_TO_QUESTIONS" | translate }}
        <span class="arrow-icon">â†’</span>
      </button>
    </div>
  </div>
</div>
